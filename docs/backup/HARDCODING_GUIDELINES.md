# 硬编码处理指南

## 📋 概述

本文档旨在规范Dir-Monitor-Go项目中的硬编码内容处理，提高代码的可维护性和可配置性。

## 🎯 统一标准

### 版本号管理
- **当前版本**: v3.2.0
- **文档统一**: 所有文档中的版本号统一为 v3.2.0
- **代码处理**: 使用构建参数注入版本信息

### 路径格式
- **统一格式**: 使用占位符 `{username}` 代替具体用户名
- **示例转换**:
  ```
  硬编码: /sftp/user2/data
  统一格式: /sftp/{username}/data
  
  硬编码: /opt/python-envs/bin/python /sftp/user2.py
  统一格式: /opt/python-envs/bin/python /sftp/{username}.py
  ```

### 日期格式
- **统一格式**: 使用占位符 `{current_date}` 代替具体日期
- **格式标准**: YYYY-MM-DD (ISO 8601)
- **示例转换**:
  ```
  硬编码: 2025-10-31
  统一格式: {current_date}
  ```

## 📁 文档硬编码统一结果

### 已处理文档
1. **CONFIG_OPTIMIZATION.md**
   - ✅ 版本号: 3.1.2 → 3.1.0 → 3.2.0
   - ✅ 路径: user2 → {username}
   - ✅ 日期: 2025-10-31 → {current_date}
   - ✅ 添加硬编码注意事项章节

2. **DESIGN.md**
   - ✅ 版本号: v3.1.0 → v3.2.0
   - ✅ 架构版本统一: v3.1.0 → v3.2.0
   - ✅ 添加硬编码注意事项章节

### 占位符使用规范
- `{username}`: 用户名占位符
- `{current_date}`: 当前日期占位符
- `{version}`: 版本号占位符

## 💻 代码硬编码分析

### 高优先级硬编码
1. **版本信息** (main.go)
   - `version = "3.2.0"`
   - `buildTime = "2025-10-31"`
   - **建议**: 使用构建参数注入

2. **默认配置值** (config.go)
   - 15个硬编码的默认配置值
   - **建议**: 配置化或通过环境变量覆盖

3. **时间常量** (monitor.go, fsnotify_watcher.go)
   - 500ms, 2000ms, 300ms, 10分钟等
   - **建议**: 定义为常量或可配置参数

### 中等优先级硬编码
1. **日志格式** (logger.go)
   - 时间戳格式: "2006-01-02 15:04:05"
   - **建议**: 保持现状或使用配置

2. **文件权限** (logger.go)
   - 文件权限: 0644
   - 目录权限: 0755
   - **建议**: 保持现状或定义为常量

## 🔧 改进建议

### 短期改进 (1-2周)
1. 使用构建参数注入版本信息
2. 将重要的默认配置值提取为可配置参数
3. 定义时间相关常量为具名常量

### 长期改进 (1个月+)
1. 实现配置热加载机制
2. 提供配置验证和推荐值
3. 建立自动化配置生成工具
4. 完善配置模板系统

## 📋 检查清单

### 文档检查
- [x] 版本号统一为 v3.2.0
- [x] 路径格式使用 {username} 占位符
- [x] 日期格式使用 {current_date} 占位符
- [x] 添加硬编码注意事项章节

### 代码检查
- [ ] 版本信息使用构建参数
- [ ] 默认配置值配置化
- [ ] 时间常量定义为具名常量
- [ ] 日志格式标准化

## 🚀 实施计划

1. **第一阶段**: 完成文档硬编码统一 ✅
2. **第二阶段**: 处理代码中的高优先级硬编码
3. **第三阶段**: 实现配置化改进
4. **第四阶段**: 建立自动化工具和模板系统

## 📞 联系方式

如有硬编码处理问题，请联系项目维护团队。